import pandas as pd

# --- –ù–ê–°–¢–†–û–ô–ö–ò ---
# –ò–º—è –≤–∞—à–µ–≥–æ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
INPUT_FILE = 'table_csv.csv'
# –ò–º—è —Ñ–∞–π–ª–∞, –≤ –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç
OUTPUT_FILE = 'table_csv_1.csv'
# –ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞, –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å
COLUMN_TO_CLEAN = '–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä'


def clean_name(indicator_name: str) -> str:
    """
    –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –∏ –æ—Ç—Å–µ–∫–∞–µ—Ç –µ–¥–∏–Ω–∏—Ü—É –∏–∑–º–µ—Ä–µ–Ω–∏—è,
    –∫–æ—Ç–æ—Ä–∞—è –æ–±—ã—á–Ω–æ –∏–¥–µ—Ç –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∑–∞–ø—è—Ç–æ–π.
    """
    if not isinstance(indicator_name, str):
        return ""

    # –ù–∞—Ö–æ–¥–∏–º –ø–æ–∑–∏—Ü–∏—é –ø–æ—Å–ª–µ–¥–Ω–µ–π –∑–∞–ø—è—Ç–æ–π
    last_comma_index = indicator_name.rfind(',')

    # –ï—Å–ª–∏ –∑–∞–ø—è—Ç–∞—è –Ω–∞–π–¥–µ–Ω–∞, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —á–∞—Å—Ç—å —Å—Ç—Ä–æ–∫–∏ –¥–æ –Ω–µ–µ
    if last_comma_index != -1:
        return indicator_name[:last_comma_index].strip()

    # –ï—Å–ª–∏ –∑–∞–ø—è—Ç–æ–π –Ω–µ—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∏—Å—Ö–æ–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
    return indicator_name.strip()


def main():
    """
    –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —á—Ç–µ–Ω–∏—è, –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–∞.
    """
    try:
        # –ß–∏—Ç–∞–µ–º –∏—Å—Ö–æ–¥–Ω—ã–π CSV-—Ñ–∞–π–ª, –∏—Å–ø–æ–ª—å–∑—É—è —Ç–æ—á–∫—É —Å –∑–∞–ø—è—Ç–æ–π –∫–∞–∫ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å
        print(f"üìñ –ß—Ç–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞: {INPUT_FILE}...")
        df = pd.read_csv(INPUT_FILE, engine='python', sep=';')
        print("‚úÖ –§–∞–π–ª —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—á–∏—Ç–∞–Ω.")

        # –ü—Ä–∏–º–µ–Ω—è–µ–º –Ω–∞—à—É —Ñ—É–Ω–∫—Ü–∏—é –æ—á–∏—Å—Ç–∫–∏ –∫ –Ω—É–∂–Ω–æ–º—É —Å—Ç–æ–ª–±—Ü—É
        print(f"üßπ –û—á–∏—Å—Ç–∫–∞ —Å—Ç–æ–ª–±—Ü–∞ '{COLUMN_TO_CLEAN}'...")
        df[COLUMN_TO_CLEAN] = df[COLUMN_TO_CLEAN].apply(clean_name)
        print("‚úÖ –°—Ç–æ–ª–±–µ—Ü —É—Å–ø–µ—à–Ω–æ –æ—á–∏—â–µ–Ω.")

        # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –Ω–æ–≤—ã–π —Ñ–∞–π–ª
        print(f"üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤ —Ñ–∞–π–ª: {OUTPUT_FILE}...")
        df.to_csv(OUTPUT_FILE, sep=';', index=False, encoding='utf-8')
        print(f"üéâ –ì–æ—Ç–æ–≤–æ! –û—á–∏—â–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ {OUTPUT_FILE}.")

    except FileNotFoundError:
        print(f"üî• –û–®–ò–ë–ö–ê: –§–∞–π–ª '{INPUT_FILE}' –Ω–µ –Ω–∞–π–¥–µ–Ω. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ç–æ–π –∂–µ –ø–∞–ø–∫–µ, —á—Ç–æ –∏ —Å–∫—Ä–∏–ø—Ç.")
    except Exception as e:
        print(f"üî• –ü—Ä–æ–∏–∑–æ—à–ª–∞ –Ω–µ–ø—Ä–µ–¥–≤–∏–¥–µ–Ω–Ω–∞—è –æ—à–∏–±–∫–∞: {e}")


if __name__ == "__main__":
    main()
